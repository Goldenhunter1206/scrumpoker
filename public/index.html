<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrum Poker - Team Estimation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        overflow: hidden;
    }

    .header {
        background: linear-gradient(135deg, #4f46e5, #7c3aed);
        color: white;
        padding: 30px;
        text-align: center;
    }

    .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
    }

    .header p {
        opacity: 0.9;
        font-size: 1.1em;
    }

    .main-content {
        padding: 30px;
    }

    .setup-section {
        margin-bottom: 40px;
    }

    .input-group {
        margin-bottom: 20px;
    }

    .input-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #374151;
    }

    .input-group input, .input-group textarea {
        width: 100%;
        padding: 12px;
        border: 2px solid #e5e7eb;
        border-radius: 8px;
        font-size: 16px;
        transition: border-color 0.3s;
    }

    .input-group input:focus, .input-group textarea:focus {
        outline: none;
        border-color: #4f46e5;
    }

    .btn {
        background: linear-gradient(135deg, #4f46e5, #7c3aed);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        margin: 5px;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(79, 70, 229, 0.3);
    }

    .btn-secondary {
        background: #6b7280;
    }

    .btn-danger {
        background: #dc2626;
    }

    .session-info {
        background: #f3f4f6;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 30px;
    }

    .session-info h3 {
        color: #374151;
        margin-bottom: 15px;
    }

    .ticket-info {
        background: #e0f2fe;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 30px;
        border-left: 5px solid #0ea5e9;
    }

    .voting-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 15px;
        margin: 30px 0;
    }

    .card {
        aspect-ratio: 3/4;
        background: white;
        border: 3px solid #e5e7eb;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .card.selected {
        background: linear-gradient(135deg, #4f46e5, #7c3aed);
        color: white;
        border-color: #4f46e5;
        transform: translateY(-8px);
    }

    .participants {
        margin: 30px 0;
    }

    .participant {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 15px;
        background: #f9fafb;
        border-radius: 8px;
        margin-bottom: 10px;
    }

    .participant-name {
        font-weight: 600;
        color: #374151;
    }

    .vote-status {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 500;
    }

    .voted {
        background: #dcfce7;
        color: #166534;
    }

    .not-voted {
        background: #fef3c7;
        color: #92400e;
    }

    .vote-value {
        background: #dbeafe;
        color: #1e40af;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
    }

    .results {
        background: #f0f9ff;
        padding: 25px;
        border-radius: 12px;
        margin: 30px 0;
        border: 2px solid #0ea5e9;
    }

    .results h3 {
        color: #0c4a6e;
        margin-bottom: 20px;
    }

    .stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
    }

    .stat {
        text-align: center;
        padding: 15px;
        background: white;
        border-radius: 8px;
    }

    .stat-value {
        font-size: 24px;
        font-weight: bold;
        color: #0ea5e9;
    }

    .stat-label {
        font-size: 14px;
        color: #6b7280;
        margin-top: 5px;
    }

    .hidden {
        display: none;
    }

    .room-code {
        background: #4f46e5;
        color: white;
        padding: 8px 16px;
        border-radius: 8px;
        font-family: monospace;
        font-size: 18px;
        font-weight: bold;
    }

    @media (max-width: 768px) {
        .voting-cards {
            grid-template-columns: repeat(4, 1fr);
        }
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üÉè Scrum Poker</h1>
            <p>Collaborative Story Point Estimation for Your Team</p>
        </div>

```
    <div class="main-content">
        <!-- Setup Section -->
        <div id="setup-section" class="setup-section">
            <div class="input-group">
                <label for="facilitator-name">Your Name (Facilitator)</label>
                <input type="text" id="facilitator-name" placeholder="Enter your name">
            </div>
            
            <div class="input-group">
                <label for="session-name">Session Name</label>
                <input type="text" id="session-name" placeholder="Sprint 12 Planning" value="Sprint Planning Session">
            </div>
            
            <button class="btn" onclick="startSession()">Start Session</button>
        </div>

        <!-- Session Section -->
        <div id="session-section" class="hidden">
            <div class="session-info">
                <h3>Session: <span id="current-session-name"></span></h3>
                <p><strong>Room Code:</strong> <span class="room-code" id="room-code"></span></p>
                <p><strong>Share this link:</strong> <span id="session-link"></span></p>
                <p><em>Team members can join by entering the room code or using this link</em></p>
            </div>

            <!-- Add Ticket Section -->
            <div class="input-group">
                <label for="jira-ticket">Jira Ticket (e.g., PROJ-123: Implement user authentication)</label>
                <textarea id="jira-ticket" rows="3" placeholder="PROJ-123: Implement user authentication system with OAuth2 integration"></textarea>
            </div>
            
            <button class="btn" onclick="setCurrentTicket()">Set Current Ticket</button>
            <button class="btn btn-secondary" onclick="showJoinForm()">Add Team Member</button>
            <button class="btn btn-danger" onclick="endSession()">End Session</button>

            <!-- Current Ticket -->
            <div id="current-ticket" class="ticket-info hidden">
                <h3>üìã Current Ticket</h3>
                <p id="ticket-description"></p>
            </div>

            <!-- Join Form -->
            <div id="join-form" class="session-info hidden">
                <h3>Add Team Member</h3>
                <div class="input-group">
                    <label for="member-name">Team Member Name</label>
                    <input type="text" id="member-name" placeholder="Enter team member name">
                </div>
                <button class="btn" onclick="addTeamMember()">Add Member</button>
                <button class="btn btn-secondary" onclick="hideJoinForm()">Cancel</button>
            </div>

            <!-- Voting Cards -->
            <div class="voting-cards">
                <div class="card" onclick="vote(0)">0</div>
                <div class="card" onclick="vote(0.5)">¬Ω</div>
                <div class="card" onclick="vote(1)">1</div>
                <div class="card" onclick="vote(2)">2</div>
                <div class="card" onclick="vote(3)">3</div>
                <div class="card" onclick="vote(5)">5</div>
                <div class="card" onclick="vote(8)">8</div>
                <div class="card" onclick="vote(13)">13</div>
                <div class="card" onclick="vote(21)">21</div>
                <div class="card" onclick="vote('?')">?</div>
                <div class="card" onclick="vote('‚òï')">‚òï</div>
            </div>

            <div style="text-align: center; margin: 20px 0;">
                <button class="btn" onclick="revealVotes()">Reveal Votes</button>
                <button class="btn btn-secondary" onclick="resetVoting()">New Round</button>
            </div>

            <!-- Participants -->
            <div class="participants">
                <h3>Team Members</h3>
                <div id="participants-list"></div>
            </div>

            <!-- Results -->
            <div id="results" class="results hidden">
                <h3>üìä Voting Results</h3>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="average-vote">-</div>
                        <div class="stat-label">Average</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="consensus-vote">-</div>
                        <div class="stat-label">Most Common</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="total-voters">-</div>
                        <div class="stat-label">Voters</div>
                    </div>
                </div>
                <div id="vote-breakdown"></div>
            </div>
        </div>
    </div>
</div>

<script>
    // Application state
    let gameState = {
        sessionName: '',
        facilitator: '',
        roomCode: '',
        currentTicket: '',
        participants: {},
        votes: {},
        votingRevealed: false
    };

    function generateRoomCode() {
        return Math.random().toString(36).substring(2, 8).toUpperCase();
    }

    function startSession() {
        const facilitatorName = document.getElementById('facilitator-name').value.trim();
        const sessionName = document.getElementById('session-name').value.trim();
        
        if (!facilitatorName || !sessionName) {
            alert('Please enter both your name and session name');
            return;
        }

        gameState.facilitator = facilitatorName;
        gameState.sessionName = sessionName;
        gameState.roomCode = generateRoomCode();
        
        // Add facilitator as first participant
        gameState.participants[facilitatorName] = {
            name: facilitatorName,
            isFacilitator: true,
            joinedAt: new Date()
        };

        document.getElementById('setup-section').classList.add('hidden');
        document.getElementById('session-section').classList.remove('hidden');
        
        document.getElementById('current-session-name').textContent = sessionName;
        document.getElementById('room-code').textContent = gameState.roomCode;
        document.getElementById('session-link').textContent = `${window.location.href}?room=${gameState.roomCode}`;
        
        updateParticipantsList();
    }

    function setCurrentTicket() {
        const ticket = document.getElementById('jira-ticket').value.trim();
        if (!ticket) {
            alert('Please enter a Jira ticket description');
            return;
        }

        gameState.currentTicket = ticket;
        document.getElementById('ticket-description').textContent = ticket;
        document.getElementById('current-ticket').classList.remove('hidden');
        
        // Reset voting when new ticket is set
        resetVoting();
    }

    function showJoinForm() {
        document.getElementById('join-form').classList.remove('hidden');
    }

    function hideJoinForm() {
        document.getElementById('join-form').classList.add('hidden');
        document.getElementById('member-name').value = '';
    }

    function addTeamMember() {
        const memberName = document.getElementById('member-name').value.trim();
        if (!memberName) {
            alert('Please enter a team member name');
            return;
        }

        if (gameState.participants[memberName]) {
            alert('This team member is already in the session');
            return;
        }

        gameState.participants[memberName] = {
            name: memberName,
            isFacilitator: false,
            joinedAt: new Date()
        };

        updateParticipantsList();
        hideJoinForm();
    }

    function vote(value) {
        if (!gameState.currentTicket) {
            alert('Please set a current ticket before voting');
            return;
        }

        if (gameState.votingRevealed) {
            alert('Voting is complete for this round. Start a new round to vote again.');
            return;
        }

        gameState.votes[gameState.facilitator] = value;
        
        // Update card selection
        document.querySelectorAll('.card').forEach(card => {
            card.classList.remove('selected');
        });
        event.target.classList.add('selected');
        
        updateParticipantsList();
    }

    function updateParticipantsList() {
        const list = document.getElementById('participants-list');
        list.innerHTML = '';

        Object.values(gameState.participants).forEach(participant => {
            const div = document.createElement('div');
            div.className = 'participant';
            
            const hasVoted = gameState.votes.hasOwnProperty(participant.name);
            const voteValue = gameState.votes[participant.name];
            
            let statusHtml;
            if (gameState.votingRevealed && hasVoted) {
                statusHtml = `<span class="vote-value">${voteValue}</span>`;
            } else if (hasVoted) {
                statusHtml = `<span class="vote-status voted">‚úì Voted</span>`;
            } else {
                statusHtml = `<span class="vote-status not-voted">‚è≥ Waiting</span>`;
            }
            
            div.innerHTML = `
                <span class="participant-name">
                    ${participant.name} ${participant.isFacilitator ? 'üëë' : ''}
                </span>
                ${statusHtml}
            `;
            
            list.appendChild(div);
        });
    }

    function revealVotes() {
        if (Object.keys(gameState.votes).length === 0) {
            alert('No votes to reveal yet');
            return;
        }

        gameState.votingRevealed = true;
        updateParticipantsList();
        showResults();
    }

    function showResults() {
        const votes = Object.values(gameState.votes).filter(vote => typeof vote === 'number');
        
        if (votes.length === 0) {
            document.getElementById('results').classList.add('hidden');
            return;
        }

        // Calculate statistics
        const average = votes.reduce((sum, vote) => sum + vote, 0) / votes.length;
        
        // Find most common vote
        const voteCounts = {};
        Object.values(gameState.votes).forEach(vote => {
            voteCounts[vote] = (voteCounts[vote] || 0) + 1;
        });
        
        const mostCommonVote = Object.keys(voteCounts).reduce((a, b) => 
            voteCounts[a] > voteCounts[b] ? a : b
        );

        // Update results display
        document.getElementById('average-vote').textContent = average.toFixed(1);
        document.getElementById('consensus-vote').textContent = mostCommonVote;
        document.getElementById('total-voters').textContent = Object.keys(gameState.votes).length;
        
        // Show vote breakdown
        const breakdown = document.getElementById('vote-breakdown');
        breakdown.innerHTML = '<h4>Vote Distribution:</h4>';
        
        Object.entries(voteCounts).forEach(([vote, count]) => {
            const percentage = ((count / Object.keys(gameState.votes).length) * 100).toFixed(0);
            breakdown.innerHTML += `
                <div style="margin: 5px 0;">
                    <strong>${vote}</strong>: ${count} vote${count > 1 ? 's' : ''} (${percentage}%)
                </div>
            `;
        });
        
        document.getElementById('results').classList.remove('hidden');
    }

    function resetVoting() {
        gameState.votes = {};
        gameState.votingRevealed = false;
        
        // Clear card selections
        document.querySelectorAll('.card').forEach(card => {
            card.classList.remove('selected');
        });
        
        document.getElementById('results').classList.add('hidden');
        updateParticipantsList();
    }

    function endSession() {
        if (confirm('Are you sure you want to end this session?')) {
            location.reload();
        }
    }

    // Check if joining existing session
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const roomCode = urlParams.get('room');
        
        if (roomCode) {
            // In a real implementation, this would connect to the existing session
            alert(`Joining room ${roomCode}. In a real implementation, this would connect you to the existing session.`);
        }
    };
</script>
```

</body>
</html>
